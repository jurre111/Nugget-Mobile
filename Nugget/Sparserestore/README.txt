This is a complete Swift rewrite from https://github.com/JJTech0130/TrollRestore/tree/main/sparserestore
